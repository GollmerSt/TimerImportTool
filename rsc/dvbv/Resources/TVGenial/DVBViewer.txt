//
//   A C H T U N G   Diese Datei nicht modifizieren !!!!!
//
//      Modifizierungen nur im Setupo des TimerImportTool vornehmen!!!
//
//  TVgenial  TV-Recorder Interface  Script File
//  TVgenial  TV-Recorder Schnittstellen Script
//
// Modified for DVBViewer-TimerImportTool 
//
//  Version: 21.März.2010
//  ____________________________________________________________________________________________

StartOffset = 0
EndOffset = 0

DoRecord javaw ' -jar "%JAR_File%" -TVGenial TVUID='u' Start='yyyymmddhhnn' Dauer='j' Sendung="'#'"'

//
//  Kommandos
//  *********
//
//  Folgende Parameter können vom Programm umgesetzt werden
//
//
//	d	Tag als Zahl (Startzeit) ohne führende Null (1-31).
//	dd	Tag als Zahl (Startzeit) mit führender Null (01-31).
//
//	m	Monat als Zahl (Startzeit) ohne führende Null (1-12).
//		Sie sollten besser immer zwei m verwenden, da sonst ein missverständliches Format wie z.B. 16.3 konvertiert wird.
//	mm	Monat als Zahl (Startzeit) mit führender Null (01-12).
//
//	yy	Jahr als Zahl (Startzeit) als zweistellige Zahl (00-99).
//	yyyy	Jahr als Zahl (Startzeit) als vierstellige Zahl (0000-9999).
//
//
//	h	Stunde (Startzeit) ohne führende Null (0-23).
//	hh	Stunde (Startzeit) mit führender Null (00-23).
//
//	n	Minute (Startzeit) ohne führende Null (0-59).
//	nn	Minute (Startzeit) mit führender Null (00-59).
//
//	q	Tag als Zahl (Endzeit) ohne führende Null (1-31).
//	qq	Tag als Zahl (Endzeit) mit führender Null (01-31).
//
//	w	Monat als Zahl (Endzeit) ohne führende Null (1-12).
//	ww	Monat als Zahl (Endzeit) mit führender Null (01-12).
//
//	ee	Jahr als Zahl (Endzeit) als zweistellige Zahl (00-99).
//	eeee	Jahr als Zahl (Endzeit) als vierstellige Zahl (0000-9999).
//
//	r	Stunde (Endzeit) ohne führende Null (0-23).
//	rr	Stunde (Endzeit) mit führender Null (00-23).
//
//	f	Minute (Endzeit) ohne führende Null (0-59).
//	ff	Minute (Endzeit) mit führender Null (00-59).
//
//	'' ""	In halbe oder ganze Anführungszeichen eingeschlossene Zeichen wirken sich nicht auf die Formatierung aus und werden wie eingegeben angezeigt.
//		Um z.B. wörter wie do record direkt weiterzuleiten, verwenden Sie 'do record' oder "do record"
//              Um das Zeichen " darzustellen, nutzen Sie '"'
//              Um das Zeichen ' darzustellen, nutzen Sie "'"
//              Bsp.:  a'b"c"d'e"f'g'"  =>  ab"c"def'g'
//
//	#	Titel der Sendung in voller Länge.
//	####	Titel der Sendung, eingepasst in die Anzahl der # Zeichen. Längere Titel werden abgeschnitten.
//		Kürzere werden mit Leerzeichen bis zum letzten # Zeichen aufgefüllt.
//              Seit der Version 2.30 werden die Sonderzeichen '()!/?&$§"*: und ; vor der Verwendung
//              herausgefiltert und durch Leerzeichen ersetzt. Bei der Verwendung von **** (s.u.) werden die
//              Leerzeichen gelöscht.
//
//	*	Titel der Sendung ohne Leerzeichen in voller Länge.
//	****	Titel der Sendung ohne Leerzeichen, eingepasst in die Anzahl der * Zeichen. Längere Titel werden abgeschnitten.
//		Kürzere werden mit Leerzeichen bis zum letzten * Zeichen aufgefüllt.
//
//	%	Titel der Sendung Sonderzeichen und Leerzeichen durch _ ersetzt, volle Länge.
//	%%%%	Titel der Sendung Sonderzeichen und Leerzeichen durch _ ersetzt, eingepasst in die Anzahl der % Zeichen.
//		Kürzere Namen werden mit _ bis zum letzten % Zeichen aufgefüllt.
//
//	i	TVgenial Sendernummer, umgewandelt nach Sendertabelle, siehe unten.
//
//      v       Von TVgenial umgewandelte Sendernummer nach der Mappingtabelle für diese Schnittstelle.
//              Die Mappingtabelle ist in TVgenial unter Optionen / Schnittstellen / Einrichten / Schnittstelle auswählen + [Kanäle]
//              zu erreichen. Dort können neue Sendernummern für jeden TVgenial-Sender vergeben werden. 
//              Damit entfällt die unten befindliche Sendernummernliste, es muss aber anstatt i der Parameter v verwendet werden.
//              Die parallele Verwendung von i und v ist aber ebenfalls möglich, soweit sinnvoll.
//              Beispiel: Zu ARD wurde in der Schnittstelle der Sender mit der Nummer 10 zugeorndet, damit ist v = 10
//                   Oder zu ZDF wurde in der Schnittstelle der Sender mit der Nummer 100.2 zugeorndet, damit ist v = 100.2
//                   Oder bei ARD wurde Ac0024 definiert, dann ist v = Ac0024.
//
//      u       TVUID: Television Universal Identification 
//              Sendernummer nach einheitlicher Senderkodierung, 7 stellige Nummer
//              Kodierung ist zu finden unter: www.ARAKON-Systems.de
//              Anstelle des u wird die Nummer eingesetzt. Diese Kodierung muss vom Aufnahmeprogramm
//              unterstützt werden, der Vorteil liegt in einer absolut eindeutigen Zuordnung der Sender, das
//              Ausfüllen der Senderzuordnungstabelle ist dann nicht mehr nötig.
//
//      s       Senderkurzname - wie in TVgenial verwendet (nicht die in dieser Datei eingetragene Verknüpfung)
//      ss      Senderkurzname - wie in TVgenial verwendet, die Leerzeichen werden durch einen Unterstrich ersetzt.
//                               Beispiel: RTL II  --> RTL_II  
//
//	j	Sendungsdauer, als Zahl in Minuten ohne führende Null (0-9999).
//      k       Sendungsdauer, als Zahl in Sekunden ohne führende Null (0-999999).
//
//      g       Genre ID (integer)
//
//	Die Formatbezeichner können beliebig in Groß- oder Kleinbuchstaben angegeben werden,
//	da sich die Schreibweise nicht auf das Ergebnis der Formatierung auswirkt.
//
//      Hinweis: Alle Zeitangaben zur Start und Endzeit werden nach den allgemeinen Richtlinien des Standardzeitformates berechnet.
//               Eine Verschiebung der Zeiten zu Gunsten der "Sehgewohnheiten" findet nicht statt !
//               Der Tag beginnt mit 00:00:00 Uhr und endet bei 23.59:59.
//               Eine Sendung nach Mitternacht an einem Mittwoch um 0:10 Uhr beginnt demnach am Donnerstag um 0:10 Uhr.
//
//               Der Parameter | ist entfallen. Deklarieren Sie stattdessen einfach mehrere Dorecord nacheinander. 
//   ________________________________________________________________________________________________
//
//   Kalibrierung der Aufnahmezeiten :
//
//   Startzeit um x Sekunden verschieben :  StartOffset = x
//   Endzeit um x Sekunden verschieben :  EndOffset = x
//   - Groß-/Kleinschreibung ohne Bedeutung
//   - Angaben in Sekunden
//   - Zurückverschieben (Früher) = negative Werte
//   - Weiterverschieben (Später) = positive Werte
//   - Standardeinstellung = 0
//   - Die Sendedauer (min oder sec) wird angepasst
//   - Die Werte StartOffset und EndOffset werden jeweils mit den in TVgenial (ab V3.40) eingestellten Zeiten
//       (Optionen/Aufnahme/Allgemeine Einstellungen) verrechnet. Die hier eingestellten Werte sollten an 
//       die Hardware angepasst werden. Die im Programm definierten Werte an die persönlichen Interessen.
//       
//   - Beispiel : StartOffset = -180   der Aufnahmestart findet 3 Minuten früher statt
//   - Beispiel : StartOffset = - 180  Fehler !! keine Leerzeichen nach dem Minus, StartOffset wird bleibt null


//   ________________________________________________________________________________________________
//
//   Debug Informationen
//
//   setzen Sie einfach den Befehl show_parameters, um sich die von TVgenial übergebenen parameter
//   nach der Scriptverarbeitung zu prüfen. Die Zeile darf keine weiteren Angaben enthalten.
//   Hinweis: alle Aufrufe werden immer in der Datei startlog.txt im TVgenial Verzeichnis protokolliert.
//
// show_parameters
//   ________________________________________________________________________________________________
//
//   RemindCall
//
//   Dieses Kommando kann zum starten eines externen Programmes verwendet werden, wenn eine Erinnerung 
//   in TVgenial gestartet wird. 
//   Dazu müssen zwei Bedingungen erfüllt sein: 
//    1. es muss der Parameter RemindCall hier im Script definiert sein, und....
//    2. es muss die Scriptschnittstellendatei angegeben sein (in den Optionen/Vormerker/"Script für unbekanntes Gerät)
//       Die Schnittstelle kann dann sogar wieder verändert werden, z.B. auf Pinnacle, das Script wird dann dennoch 
//       ausgewertet.
//   
//   Es werden die kompletten Routinen zur Umsetzung der Parameter durchlaufen, d.h. Sendezeiten oder Sendeplatz , etc. werden 
//   umgesetzt.
//   Hinweis: Wenn Sie das Programm manuell starten möchten, dann aktivieren Sie den Schalter "manuell aus der Erinnerung starten"
//            Es erscheint dann ein extra Schalter im Erinnerungsfenster.
//   Hinweis: Eine Definition des Parameters RemindCall überschreibt die Angabe in den Optionen 
//
//   ________________________________________________________________________________________________
//

// Kommandozeilen:
//
//     DoRecord         [programmpfadname] [parameter]
//     DoRecordWaitFor  [programmpfadname] [parameter]
//     DoDelete         [programmpfadname] [parameter]
//     DoDeleteWaitFor  [programmpfadname] [parameter]
//     RemindCall       [programmpfadname] [parameter]
//
//  Sollten im [programmpfadname] Verzeichnisnamen mit Leerzeichen (Space) enthalten sein und TVgenial 
//  diese nicht korrekt erkennen, dann stellen Sie die Angaben in Anführungszeichen " oder '
//  Die Verwendung ist jedoch nicht zwingend notwendig.
//
// führende und endständige Leerzeichen werden abgeschnitten, alle übrigen werden wie angegeben verwendet.
// Sie finden hier einige Beispiele, entfernen Sie die führenden Schrägstriche, um die Zeile zu aktivieren.
//
// Es wird die Auswertung des Rückgabewertes der aufgerufenen Datei unterstützt. Dazu muss das Kommando
//   DoRecordWaitfor oder DoDeleteWaitfor
// verwendet werden. TVgenial wartet dann solange, bis das aufgerufene Programm fertig ist und wertet den
// Rückgabewert (Error-Code) aus, jeder Wert <> 0 bedeutet einen Fehler und die Aufnahme wird als nicht 
// programmiert angesehen. Der Rückgabewert 0 bedeutet eine erfolgreiche Verarbeitung.
//
// Hinweis: Sollte sich das externe Programm nicht reagieren, dann kehrt TVgenial nach 30 Sekunden automatisch 
//  mit einem Fehler zurück.
//
//
//
// Sender Tag.Monat.Jahr Stunde.Minute Dauer Titel
//   (z.B.  004 24.02.2002 20.15 45 Tierwelten am Amazonas)
//DoRecord C:\Programme\Recorder.exe  i dd.mm.yyyy hh.nn j #
//
// Tag.Monat.Jahr Sender Stunde.Minute Dauer Titel
//   (z.B.  24.02.2002 20.15 4 45 Tierwelten am Amazonas)
//DoRecord C:\Programme\Recorder.exe dd.mm.yyyy hh.nn i j #
//
// Tag.Monat.Jahr Sender Stunde.Minute Dauer Titel
//   (z.B.  24.2.02 20.15 4 45 Tierwelten am Amazonas)
//DoRecord C:\Programme\Recorder.exe d.m.yy h.n i j #
//
// Tag:Monat:Jahr Stunde:Minute Sender Dauer >Titel<
//   (z.B.  24:02:2002 20:15 4 45 >Tierwelten am Amazonas<)
//DoRecord C:\Programme\Recorder.exe dd:mm:yyyy hh:nn i j >#<
//
// Tag:Monat:Jahr Stunde:Minute Sender Dauer >Titel<
//   (z.B.  24:02:2002 20:15 (Sat 1) 45 Tierwelten am Amazonas)
//DoRecord C:\Programme\Recorder.exe dd:mm:yyyy hh:nn (i) j >#<
//
// Tag:Monat:Jahr-Stunde:Minute Tag:Monat:Jahr-Stunde:Minute Sender >Titel<
//   (z.B.  24:02:2002-20:15 24:02:2002-21:00 (0010001) >Tierwelten am Amazonas<)
//DoRecord C:\Programme\Recorder.exe dd:mm:yyyy-hh:nn qq:ww:eeee-rr:ff (u) >#<
//
// Tag:Monat:Jahr Stunde:Minute (SenderName) Dauer >Titel<
//   (z.B.  24:02:2002 20:15 (Sat 1) 45 >Tierwelten am Amazonas<)
//DoRecord C:\Programme\Recorder.exe dd:mm:yyyy hh:nn (i) j >#<
//
// Tag Monat Stunde:Minute SenderID %Titel%
//   (z.B.  24 02 02 20:15 4 45 %Tierwelten am A%)
//DoRecord "C:\my programms\Recorder.exe" dd mm yy hh:nn i j >###############<
//
// Tag:Monat:Jahr-Stunde:Minute Tag:Monat:Jahr-Stunde:Minute Sender >Titel<
//   (z.B.  24:02:2002-20:15 24:02:2002-21:00 (Sat 1) >Tierwelten am Amazonas   <)
//DoRecord C:\Programme\Recorder.exe dd:mm:yyyy-hh:nn qq:ww:eeee-rr:ff (i) >#########################<
//
// Tag:Monat:Jahr-Stunde:Minute Tag:Monat:Jahr-Stunde:Minute Sender >Titel<
//   (z.B.  -rec 24:02:2002-20:15 24:02:2002-21:00  "TierweltenamAmazonas")
//DoRecord C:\Programme\Recorder.exe '-rec' dd:mm:yyyy-hh:nn qq:ww:eeee-rr:ff  '"'*'"'
//
// 'nimm mal folgendes auf:' Tag:Monat:Jahr-Stunde:Minute Tag:Monat:Jahr-Stunde:Minute Sender >Titel<
//  (z.B.  nimm mal folgendes auf: 24:02:2002-20:15 24:02:2002-21:00 (Sat 1) >Tierwelten am Amazonas <)




//  LÖSCHEN
// 
//  Um Sendungsprogrammierungen zu löschen, verwenden Sie Kommandos mit der Bezeichnung DoDelete oder DoDeleteWaitFor
//  Ihr TV-Gerät muss das Löschen von Programmierungen unterstützen.
//  Werden mehrere Löschanweisungen angegeben, dann werden auch mehrere abgearbeitet! Also immer die
//  nicht benötigten Zeilen deaktivieren
//
//  dieses Beispiel:  DoDelete C:\Programme\Recorder.exe '-Delete' dd.mm.yyyy;hh:nn;qq.ww.eeee;rr:ff;i;#
//          erzeugt:  DoDelete C:\Programme\Recorder.exe -Delete 24.06.2003;20:15;24.06.2003;22:10;ZDF;Wetten dass...?
//
//  dieses Beispiel:  DoDeleteWaitFor C:\Programme\Recorder.exe '"-del"' dd.mm.yyyy;hh:nn;i;"'"#"'"
//          erzeugt:  DoDeleteWaitFor C:\Programme\Recorder.exe "-del" 24.06.2003;20:15;ZDF;'Wetten dass...?'
//

//  Beispiel für VirtualDVR
//  dieses Beispiel:  DoRecord c:\dein\pfad\zu\VirtualDVR.exe '-add' dd.mm.yyyy;hh:nn;qq.ww.eeee;rr:ff;i;#
//          erzeugt:  DoRecord c:\dein\pfad\zu\VirtualDVR.exe -add 24.06.2003;20:15;24.06.2003;22:10;ZDF;Wetten dass...?

//   Beispiel für Haupauge WIN-TV-PVR
//  1  =  c10           // ARD
//  .....
//   Für den Windows Taskplaner: in der zeile "DoRecord" den parameter USERNAME in ihren USERNAMEN ändern und PASSWORT in ihr dazugehöriges PASSWORT ändern
//   Haben Sie die Sender in der TV-Applikation nach Preset sortiert, dann gilt die 1. Zeile:
//   Haben Sie die Sender in der TV-Applikation nach Kanälen sortiert (z.B. 1 = c10 //ARD), dann gilt die 2. Zeile Zeile:
// DoRecord c:\windows\system32\schtasks.exe '/create /tn "' #ddmmhhnn '" /tr "c:\programme\wintv\wintv2k -p'i' -ntod -startr:'*ddmmyyyyhhnn'.mpg -limit:'k'" /sc einmal /st 'hh:nn':00 /sd 'dd'/'mm'/'yyyy' /ru BENUTZERNAME /rp PASSWORT' 
// DoRecord c:\windows\system32\schtasks.exe '/create /tn "' #ddmmhhnn '" /tr "c:\programme\wintv\wintv2k -c'i' -ntod -startr:'*ddmmyyyyhhnn'.mpg -limit:'k'" /sc einmal /st 'hh:nn':00 /sd 'dd'/'mm'/'yyyy' /ru BENUTZERNAME /rp PASSWORT' 
//   Zum löschen folgenden Befehl aktivieren:

DoDelete c:\windows\system32\schtasks.exe '/delete /tn "' #ddmmhhnn '" /f'



//  RemindCall: dieses Beispiel startet zu einer Erinnerung ihre TV-Applikation und schaltet auf einen Sender um
//  diese Funktion überschreib die in den Optionen angegebene Datei
//  
RemindCall 'C:\Eigene_Dateien\ShowTV.exe' 'channel='i
